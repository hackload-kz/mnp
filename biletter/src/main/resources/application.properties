server.port=8081

spring.application.name=biletter
spring.jackson.property-naming-strategy=SNAKE_CASE

#admin
spring.boot.admin.client.url=http://localhost:8084
spring.boot.admin.client.username=admin
spring.boot.admin.client.password=admin

management.endpoints.web.exposure.include=*
management.endpoint.health.show-details=always

# Database configuration
spring.datasource.driver-class-name=org.postgresql.Driver
spring.datasource.url=${DB_URL:jdbc:postgresql://82.115.42.90:5432/postgres}
spring.datasource.username=${DB_USERNAME:mnp}
spring.datasource.password=${DB_PASS:Mnpartners1!}
spring.datasource.hikari.auto-commit=false

spring.datasource.hikari.pool-name=${spring.application.name}-pool

spring.jpa.hibernate.ddl-auto=validate

# Redis configuration for high load
spring.data.redis.host=${REDIS_HOST:82.115.42.108}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.password=${REDIS_PASSWORD:}
spring.data.redis.database=0
spring.data.redis.timeout=2000ms

# Cache configuration
spring.cache.type=redis
spring.cache.redis.time-to-live=10m
spring.cache.redis.cache-null-values=false

# User cache timing configuration - OPTIMIZED FOR HIGH LOAD (100,000 tickets/hour)
app.cache.user.preload-interval-minutes=2
app.cache.user.recent-minutes=10
app.cache.user.active-days=1
app.cache.user.max-preload-users=50000
app.cache.user.preloading-enabled=true
app.cache.user.statistics-enabled=true
app.cache.user.aggressive-caching=true
app.cache.user.cache-cleanup-interval-minutes=5
app.cache.user.max-preload-threads=8
app.cache.user.batch-size=1000

# High-load Redis configuration
spring.data.redis.lettuce.pool.max-active=50
spring.data.redis.lettuce.pool.max-idle=20
spring.data.redis.lettuce.pool.min-idle=10
spring.data.redis.lettuce.pool.max-wait=500ms

# High-load database configuration
spring.datasource.hikari.maximum-pool-size=50
spring.datasource.hikari.minimum-idle=20
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# High-load JPA configuration
spring.jpa.properties.hibernate.jdbc.batch_size=100
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.connection.provider_disables_autocommit=true

# Logging for performance monitoring
logging.level.kz.mn.partners.mnp.v1.biletter=INFO
logging.level.org.springframework.cache=DEBUG
logging.level.org.springframework.security=DEBUG

# Performance tuning
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true